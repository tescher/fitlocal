{% extends "base.html" %}
{% block title %}FitLocal - Dashboard{% endblock %}
{% block content %}
<h1>Welcome, {{ profile.name }}!</h1>

<div class="stats-grid">
    <div class="stat-card">
        <div class="stat-value">{{ days_trained }}</div>
        <div class="stat-label">Days This Week</div>
    </div>
    <div class="stat-card">
        <div class="stat-value">{{ last_session.date.strftime('%b %d') if last_session else '---' }}</div>
        <div class="stat-label">Last Session</div>
    </div>
    <div class="stat-card">
        <div class="stat-value streak-value">{{ profile.current_streak }}</div>
        <div class="stat-label">Streak</div>
    </div>
    <div class="stat-card">
        <div class="stat-value">{{ profile.longest_streak }}</div>
        <div class="stat-label">Best Streak</div>
    </div>
</div>

<!-- Mini Calendar -->
<div class="mini-calendar">
    {% for day in mini_cal %}
    <div class="mini-day {{ 'completed' if day.completed else '' }} {{ 'today' if day.is_today else '' }}">
        <span class="mini-day-name">{{ day.date.strftime('%a') }}</span>
        <span class="mini-day-num">{{ day.date.day }}</span>
        {% if day.completed %}<span class="mini-check">&#10003;</span>{% endif %}
    </div>
    {% endfor %}
</div>

{% if current_phase %}
<div class="phase-card">
    <div class="phase-header">
        <span class="phase-badge {{ current_phase.phase_type }}">{{ current_phase.phase_type|upper }}</span>
        <strong>{{ current_phase.phase_name }}</strong>
        <span class="text-muted">Week {{ active_plan.current_week }} of {{ active_plan.total_weeks }}</span>
    </div>
    <p class="text-muted">{{ current_phase.description }}</p>
    {% if current_phase.nutrition_guide %}
    <div class="nutrition-tip">
        <strong>Nutrition Tip:</strong> {{ current_phase.nutrition_guide }}
    </div>
    {% endif %}
</div>
{% endif %}

{% if active_plan %}
    <div class="card">
        <h2>Today - {{ today_name }}</h2>
        {% if todays_workout %}
            <p class="mb-2">Scheduled: <strong>{{ todays_workout.workout_name }}</strong></p>
            <a href="{{ url_for('workout_today') }}" class="btn btn-primary">Start Workout</a>
        {% else %}
            <p class="text-muted">No workout scheduled today. Rest day!</p>
        {% endif %}
    </div>
{% else %}
    <div class="card">
        <h2>Get Started</h2>
        <p class="mb-2">You don't have an active workout plan yet.</p>
        <a href="{{ url_for('generate_plan') }}" class="btn btn-primary">Generate a Plan</a>
    </div>
{% endif %}
{% endblock %}
